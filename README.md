# Wazuh Integration with VirusTotal
This project demonstrates the integration of Wazuh with the VirusTotal API to check file integrity. When a file is uploaded or downloaded on the Wazuh agent, its hash is sent to VirusTotal for analysis. The setup uses EICAR malware as a test file to verify detection.

### UML Diagram
Refer to the UML diagram to understand the workflow:
![Untitled Diagram drawio (2)](https://github.com/user-attachments/assets/a996e4cc-61d6-47cd-9ef4-50501dc715dc)


- File Integrity Check: Monitors the agent for file uploads or downloads.
- Detection Rules: Uses rules 550 and 554 to detect file changes.
- VirusTotal Integration: Sends file hashes to VirusTotal for validation.

#### Screenshots
##### - Rule for Integrity Check: The rule that triggers the VirusTotal API call upon detecting file changes.
![rule for intergrity](https://github.com/user-attachments/assets/6a6650e8-1b6e-485e-ade7-779a5f2dd0a4)

##### - VirusTotal Alert Logs: Logs showing alerts generated by VirusTotal.
![detected](https://github.com/user-attachments/assets/228cceab-51af-4546-ad67-0e1b34702c4a)

##### - Log Description of VirusTotal Alert: Detailed information about the VirusTotal alert.
![log description](https://github.com/user-attachments/assets/c5669a9f-06e4-4ae0-8c1d-4ddd3aa13197)

##### - VirusTotal API Integration: Configuration in ossec.conf for integrating VirusTotal API with Wazuh Manager.
![config chnages](https://github.com/user-attachments/assets/a2190ee6-f5a1-4890-816c-78f0dc2ad116)

### Setup and Configuration
##### Prerequisites

- ###### Wazuh Manager deployed on Ubuntu.
- ######  Wazuh Agent configured on the machine where file integrity will be monitored.
- ######  VirusTotal API key.

### Test the Setup
##### Upload or download the EICAR test file on the Wazuh agent.
##### Check that the Wazuh agent detects the file and sends the hash to VirusTotal.
##### Verify that the VirusTotal alert is generated on the Wazuh manager.

